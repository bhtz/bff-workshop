<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>BFF / Frontend workshop</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="definition.html">Definition</a></li><li class="chapter-item expanded affix "><a href="specification.html">Specification</a></li><li class="chapter-item expanded affix "><a href="roadmap.html">Roadmap</a></li><li class="chapter-item expanded affix "><a href="contributing.html">Contributing</a></li><li class="chapter-item expanded affix "><li class="part-title">Stacks</li><li class="chapter-item expanded "><a href="technos/blazor.html"><strong aria-hidden="true">1.</strong> Blazor</a></li><li class="chapter-item expanded "><a href="technos/angular.html"><strong aria-hidden="true">2.</strong> Angular</a></li><li class="chapter-item expanded "><a href="technos/nextjs.html"><strong aria-hidden="true">3.</strong> Nextjs</a></li><li class="chapter-item expanded "><a href="technos/nuxt.html"><strong aria-hidden="true">4.</strong> Nuxt</a></li><li class="chapter-item expanded "><a href="technos/yew.html"><strong aria-hidden="true">5.</strong> Yew</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">BFF / Frontend workshop</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bff--frontend-workshop"><a class="header" href="#bff--frontend-workshop">BFF / Frontend workshop</a></h1>
<p>💡 Project templates to compare stacks around the BFF &amp; SPA pattern (Backend For Frontend &amp; Single Page Application)</p>
<blockquote>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/GitHub_Invertocat_Logo.svg/800px-GitHub_Invertocat_Logo.svg.png" width="15"> <a href="https://github.com/bhtz/bff-workshop">Repository Github</a></p>
</blockquote>
<h2 id="stacks"><a class="header" href="#stacks">Stacks</a></h2>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/Blazor.png" width="25"> ASP NET - Blazor <br></p>
<p><img src="https://cdn4.iconfinder.com/data/icons/logos-and-brands/512/21_Angular_logo_logos-512.png" width="25"> Express - Angular <br></p>
<p><img src="https://seeklogo.com/images/N/next-js-logo-8FCFF51DD2-seeklogo.com.png" width="25"> Nextjs - React <br></p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Nuxt_logo.svg/2560px-Nuxt_logo.svg.png" width="25"> Nuxt - Vue <br></p>
<p><img src="https://yew.rs/img/logo.svg" width="25"> Actix - Yew (coming soon ...) <br></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bff-backend-for-frontend"><a class="header" href="#bff-backend-for-frontend">BFF (Backend For Frontend):</a></h1>
<p>BFF, short for Backend For Frontend, is a software architectural pattern used in the development of web applications. It involves the creation of dedicated backend services tailored to specific frontend applications or client devices. The primary purpose of a BFF is to optimize the communication between the frontend and backend components by providing tailored endpoints and data structures that precisely match the requirements of the frontend application.</p>
<p><strong>Key Features</strong>:</p>
<ol>
<li>
<p><strong>Customized API Endpoints</strong>: A BFF exposes a set of API endpoints specifically designed to fulfill the needs of the frontend application. These endpoints are structured to provide only the data and functionality required by the frontend, minimizing unnecessary data transfer and processing.</p>
</li>
<li>
<p><strong>Optimized Data Formatting</strong>: BFFs format data in a way that is most suitable for consumption by the frontend, reducing the need for additional processing or transformation on the client side. This includes tasks such as data aggregation, filtering, and pagination.</p>
</li>
<li>
<p><strong>Performance Enhancement</strong>: By tailoring backend services to the requirements of the frontend, BFFs can improve the performance of web applications. This optimization reduces latency and enhances the overall responsiveness of the user interface.</p>
</li>
<li>
<p><strong>Security and Authorization</strong>: BFFs enforce security measures and access control mechanisms specific to the frontend application. This ensures that only authorized users can access the data and functionality exposed by the backend services.</p>
</li>
<li>
<p><strong>Aggregation of Backend Services</strong>: In cases where the frontend application needs to interact with multiple backend services, a BFF can serve as an aggregation layer, consolidating data and functionality from various sources into a single interface for the client.</p>
</li>
<li>
<p><strong>Flexibility and Scalability</strong>: BFF architecture allows for flexibility in adapting backend services to the evolving needs of the frontend application. It also facilitates the scalability of the system by enabling independent scaling of backend services tailored to different frontend components or versions.</p>
</li>
<li>
<p><strong>Improved Development Workflow</strong>: Separating backend services based on frontend requirements simplifies the development workflow by enabling frontend and backend teams to work more independently. This leads to faster iterations, easier debugging, and better overall collaboration between teams.</p>
</li>
</ol>
<p>In summary, BFF (Backend For Frontend) is a software architectural pattern that enhances the performance, security, and development workflow of web applications by tailoring backend services to the specific needs of frontend applications or client devices.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="specification"><a class="header" href="#specification">Specification</a></h1>
<blockquote>
<p>To add a &quot;BFF/Frontend&quot; stack reference to this repository, here is the following specifications :</p>
</blockquote>
<h2 id="material-ui"><a class="header" href="#material-ui">Material UI</a></h2>
<ul>
<li>Add material UI design system
<ul>
<li>color primary by techno</li>
<li>layout with app bar &amp; collapsable sidemenu to rail</li>
</ul>
</li>
</ul>
<h2 id="custom-endpoint"><a class="header" href="#custom-endpoint">Custom endpoint</a></h2>
<ul>
<li>Expose custom server endpoint to &quot;/version&quot;
<ul>
<li>return { version: &quot;1.0.0&quot; }</li>
</ul>
</li>
</ul>
<h2 id="server-side-rendering"><a class="header" href="#server-side-rendering">Server side rendering</a></h2>
<ul>
<li>Expose frontend web application with SSR
<ul>
<li>pre-rendering page with data</li>
<li>fallback into interactive UI</li>
</ul>
</li>
</ul>
<h2 id="oidc--cookie-authentication"><a class="header" href="#oidc--cookie-authentication">OIDC &amp; cookie authentication</a></h2>
<ul>
<li>Handle OIDC auth over keycloak SSO</li>
<li>Cookie &amp; antiforgery token</li>
<li>Login / Logout clean process</li>
</ul>
<h2 id="proxying-api"><a class="header" href="#proxying-api">Proxying API</a></h2>
<ul>
<li>Proxying downsteam REST API
<ul>
<li>Proxying jsonplaceholder &quot;todos&quot; API with route &quot;/api/todos&quot;</li>
<li><a href="https://jsonplaceholder.typicode.com/">https://jsonplaceholder.typicode.com/</a></li>
<li>Page listing posts exposed by API</li>
</ul>
</li>
</ul>
<h2 id="graphql-gateway"><a class="header" href="#graphql-gateway">GraphQL gateway</a></h2>
<ul>
<li>Gateway GraphQL over downstream subgraph
<ul>
<li>Gateway over &quot;countries&quot; graph trevorblades</li>
<li><a href="https://countries.trevorblades.com/">https://countries.trevorblades.com/</a></li>
<li>Page listing continents exposed by API</li>
</ul>
</li>
</ul>
<h2 id="auto-generated-sdk"><a class="header" href="#auto-generated-sdk">Auto generated SDK</a></h2>
<ul>
<li>SDK to consume BFF GraphQL schema
<ul>
<li>Auto generate it from BFF url</li>
<li>Use it in frontend application</li>
</ul>
</li>
</ul>
<h2 id="light--dark-theme"><a class="header" href="#light--dark-theme">Light / Dark theme</a></h2>
<ul>
<li>Theme switcher implementation</li>
</ul>
<h2 id="i18n"><a class="header" href="#i18n">I18N</a></h2>
<ul>
<li>I18N switcher : FR &amp; EN</li>
</ul>
<h2 id="feature-management"><a class="header" href="#feature-management">Feature management</a></h2>
<ul>
<li>BFF expose feature management configuration
<ul>
<li>Enable / disable flag from config and show &quot;User&quot; page link in sidemenu accordingly (A/B testing)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h1>
<h3 id="aspnet---blazor"><a class="header" href="#aspnet---blazor">ASP.NET - Blazor</a></h3>
<ul>
<li>✅ Material UI</li>
<li>✅ Custom endpoint</li>
<li>✅ Server side rendering</li>
<li>✅ OIDC / Cookie authentication</li>
<li>✅ Proxying API</li>
<li>✅ GraphQL gateway</li>
<li>✅ Auto generated SDK</li>
<li>✅ Light / Dark theme</li>
<li>✅ I18N</li>
<li>✅ Feature management</li>
</ul>
<h3 id="express---angular"><a class="header" href="#express---angular">Express - Angular</a></h3>
<ul>
<li>✅ Material UI</li>
<li>✅ Custom endpoint</li>
<li>✅ Server side rendering</li>
<li>✅ OIDC / Cookie authentication (to 🧹)</li>
<li>✅ Proxying API</li>
<li>🛠️ GraphQL gateway</li>
<li>🚫 Auto generated SDK</li>
<li>🚫 Light / Dark theme</li>
<li>🚫 I18N</li>
<li>🚫 Feature management</li>
</ul>
<h3 id="nuxt---vue"><a class="header" href="#nuxt---vue">Nuxt - Vue</a></h3>
<ul>
<li>✅ Material UI</li>
<li>✅ Custom endpoint</li>
<li>✅ Server side rendering</li>
<li>🛠️ OIDC / Cookie authentication</li>
<li>✅ Proxying API</li>
<li>🚫 GraphQL gateway</li>
<li>🚫 Auto generated SDK</li>
<li>🚫 Light / Dark theme</li>
<li>🚫 I18N</li>
<li>🚫 Feature management</li>
</ul>
<h3 id="nextjs---react"><a class="header" href="#nextjs---react">Nextjs - React</a></h3>
<ul>
<li>🛠️ Material UI</li>
<li>✅ Custom endpoint</li>
<li>✅ Server side rendering</li>
<li>🚫 OIDC / Cookie authentication</li>
<li>🛠️ Proxying API</li>
<li>🚫 GraphQL gateway</li>
<li>🚫 Auto generated SDK</li>
<li>🚫 Light / Dark theme</li>
<li>🚫 I18N</li>
<li>🚫 Feature management</li>
</ul>
<h3 id="yew---rust-coming"><a class="header" href="#yew---rust-coming">Yew - Rust (coming)</a></h3>
<ul>
<li>🚫 Material UI</li>
<li>🚫 Custom endpoint</li>
<li>🚫 Server side rendering</li>
<li>🚫 OIDC / Cookie authentication</li>
<li>🚫 Proxying API</li>
<li>🚫 GraphQL gateway</li>
<li>🚫 Auto generated SDK</li>
<li>🚫 Light / Dark theme</li>
<li>🚫 I18N</li>
<li>🚫 Feature management</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<ul>
<li>node 18+ SDK</li>
<li>dotnet 8 SDK</li>
<li>docker engine</li>
</ul>
<h2 id="building-documentation"><a class="header" href="#building-documentation">Building documentation</a></h2>
<blockquote>
<p>Open documentation using mdbook</p>
</blockquote>
<pre><code class="language-console">cd ./doc
mdbook serve -p 5555
</code></pre>
<h2 id="iac"><a class="header" href="#iac">IAC</a></h2>
<pre><code class="language-console">cd ./IAC
docker-compose up
</code></pre>
<p>Go to <a href="http://localhost:8083/admin/master/console/#/microscope/clients">keycloak realm admin</a> &amp; regenerate clientSecret for &quot;boilerplate&quot; client</p>
<ul>
<li><a href="http://localhost:8083/admin/master/console/#/microscope/clients">keycloak realm admin</a>
<ul>
<li>Credentials
<ul>
<li>Client secret &gt; Regenerate</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Then set all your config file with this secret</p>
<h2 id="blazor"><a class="header" href="#blazor">Blazor</a></h2>
<pre><code class="language-console">cd ./src/blazor/Microscope.Boilerplate.Clients.BFF
dotnet run
</code></pre>
<h2 id="angular"><a class="header" href="#angular">Angular</a></h2>
<pre><code class="language-console">cd ./src/angular
npm run dev
</code></pre>
<h2 id="nuxt"><a class="header" href="#nuxt">Nuxt</a></h2>
<pre><code class="language-console">cd ./src/nuxt
npm run dev
</code></pre>
<h2 id="nextjs"><a class="header" href="#nextjs">Nextjs</a></h2>
<pre><code class="language-console">cd ./src/next
npm run dev
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="blazor-1"><a class="header" href="#blazor-1">Blazor</a></h1>
<img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/Blazor.png" width="40">
<blockquote>
<p>Blazor is a .NET frontend web framework that supports both server-side rendering and client interactivity in a single programming model</p>
</blockquote>
<ul>
<li><a href="https://dotnet.microsoft.com/en-us/apps/aspnet">Web site</a></li>
<li><a href="https://github.com/dotnet/aspnetcore">Github</a></li>
</ul>
<p><img src="technos/../public/blazor.png" alt="../public/blazor.png" /></p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<h2 id="material-ui-1"><a class="header" href="#material-ui-1">Material UI</a></h2>
<ul>
<li>Add material UI design system
<ul>
<li>color primary by techno</li>
<li>layout with app bar &amp; collapsable sidemenu to rail</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Easy intergration using <a href="https://mudblazor.com/">MudBlazor</a>. Excellent DX !</p>
</blockquote>
<pre><code class="language-c#">&lt;MudLayout&gt;
    &lt;MudAppBar Elevation=&quot;1&quot; Color=&quot;Color.Primary&quot; Dense=&quot;true&quot;&gt;
        &lt;MudIconButton Icon=&quot;@Icons.Material.Outlined.Menu&quot; Color=&quot;Color.Inherit&quot; Edge=&quot;Edge.Start&quot; OnClick=&quot;((e) =&gt; ToggleDrawer())&quot;/&gt;
        
        &lt;MudText&gt;Microscope.Boilerplate.NET&lt;/MudText&gt;
        @if (!HostingEnvironmentService.IsWebAssembly)
        {
            &lt;MudProgressCircular Class=&quot;ml-2&quot; Size=&quot;Size.Small&quot; Color=&quot;Color.Inherit&quot; Indeterminate=&quot;true&quot;&gt;&lt;/MudProgressCircular&gt;
        }
        &lt;MudSpacer/&gt;
        &lt;MudIconButton Icon=&quot;@Icons.Material.Filled.Brightness4&quot; Color=&quot;Color.Inherit&quot; OnClick=&quot;ToggleTheme&quot;/&gt;
        &lt;MudIconButton Href=&quot;https://github.com/bhtz/microscope-boilerplate&quot; Target=&quot;_blank&quot; Icon=&quot;@Icons.Custom.Brands.GitHub&quot; Color=&quot;Color.Inherit&quot;/&gt;
        &lt;LoginDisplay /&gt;
    &lt;/MudAppBar&gt;
    
    &lt;MudDrawer @bind-open=&quot;DrawerOpen&quot; ClipMode=&quot;DrawerClipMode.Always&quot; Elevation=&quot;2&quot; Variant=&quot;DrawerVariant.Mini&quot; MiniWidth=&quot;60px&quot;&gt;
        &lt;NavMenu/&gt;
    &lt;/MudDrawer&gt;
    
    &lt;MudMainContent Class=&quot;mt-16 pa-4&quot;&gt;
        @Body
    &lt;/MudMainContent&gt;
&lt;/MudLayout&gt;
</code></pre>
<pre><code class="language-c#">    private bool DrawerOpen { get; set; } = true;

    public void ToggleDrawer()
    {
        DrawerOpen = !DrawerOpen;
    }
</code></pre>
<h2 id="version-endpoint"><a class="header" href="#version-endpoint">Version endpoint</a></h2>
<blockquote>
<p>💡 Expose custom server endpoint to &quot;/version&quot; using a simple asp net minimal API endpoint</p>
</blockquote>
<pre><code class="language-c#">app.MapGet(&quot;/version&quot;, () =&gt; new { Version = &quot;1.0.0&quot; });
</code></pre>
<h2 id="server-side-rendering-1"><a class="header" href="#server-side-rendering-1">Server side rendering</a></h2>
<ul>
<li>Expose frontend web application with SSR
<ul>
<li>pre-rendering page with data</li>
<li>fallback into interactive UI</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Let blazor handle the magic : </p>
</blockquote>
<p><strong>Program.cs</strong></p>
<pre><code class="language-c#">    app.MapRazorComponents&lt;Host&gt;()
        .AddInteractiveServerRenderMode()
        .AddInteractiveWebAssemblyRenderMode()
        .AddAdditionalAssemblies(typeof(_Imports).Assembly);
</code></pre>
<p><strong>Host.cs</strong></p>
<pre><code class="language-c#">    &lt;body&gt;
        &lt;Routes @rendermode=&quot;InteractiveAuto&quot; /&gt;
        &lt;script src=&quot;_framework/blazor.web.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
</code></pre>
<h2 id="oidc--cookie-authentication-1"><a class="header" href="#oidc--cookie-authentication-1">OIDC &amp; cookie authentication</a></h2>
<ul>
<li>Handle OIDC auth over keycloak SSO</li>
<li>Cookie &amp; antiforgery token</li>
<li>Login / Logout clean process</li>
</ul>
<blockquote>
<p>💡 Simple OIDC asp net authentication</p>
</blockquote>
<pre><code class="language-c#">        services.AddAuthorization();
        services.AddAuthentication(options =&gt;
            {
                options.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;
                options.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;
            })
            .AddCookie(CookieAuthenticationDefaults.AuthenticationScheme)
            .AddOpenIdConnect(OpenIdConnectDefaults.AuthenticationScheme, options =&gt;
            {
                options.Authority = oidcAuthenticationOptions.Authority;
                options.ClientId = oidcAuthenticationOptions.ClientId;
                options.ClientSecret = oidcAuthenticationOptions.ClientSecret;

                options.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
                options.ResponseType = OpenIdConnectResponseType.Code;

                options.RequireHttpsMetadata = false;
                options.SaveTokens = true;
                options.AuthenticationMethod = OpenIdConnectRedirectBehavior.RedirectGet;
                options.TokenValidationParameters = new TokenValidationParameters
                {
                    NameClaimType = oidcAuthenticationOptions.NameClaimType,
                    RoleClaimType = oidcAuthenticationOptions.RoleClaimType
                };

                foreach (var item in oidcAuthenticationOptions.Scopes)
                {
                    options.Scope.Add(item);
                }
            });
</code></pre>
<h2 id="proxying-api-1"><a class="header" href="#proxying-api-1">Proxying API</a></h2>
<ul>
<li>Proxying downsteam REST API
<ul>
<li>Proxying jsonplaceholder &quot;todos&quot; API with route &quot;/api/todos&quot;</li>
<li><a href="https://jsonplaceholder.typicode.com/">https://jsonplaceholder.typicode.com/</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Using <a href="https://microsoft.github.io/reverse-proxy/">YARP</a></p>
</blockquote>
<pre><code class="language-c#">services
    .AddReverseProxy()
    .LoadFromConfig(configuration.GetSection(&quot;ReverseProxy&quot;));
</code></pre>
<pre><code class="language-json">  &quot;ReverseProxy&quot;: {
    &quot;Routes&quot;: {
      &quot;post-service&quot; : {
        &quot;ClusterId&quot;: &quot;post-service&quot;,
        &quot;Match&quot;: {
          &quot;Path&quot;: &quot;/api/todos/{**catch-all}&quot;
        },
        &quot;Transforms&quot;: [
          {
            &quot;PathRemovePrefix&quot;: &quot;/api&quot;
          }
        ]
      }
    },
    &quot;Clusters&quot;: {
      &quot;post-service&quot;: {
        &quot;Destinations&quot;: {
          &quot;post-service&quot;: {
            &quot;Address&quot;: &quot;https://jsonplaceholder.typicode.com&quot;
          }
        }
      }
    }
  }
</code></pre>
<h2 id="graphql-gateway-1"><a class="header" href="#graphql-gateway-1">GraphQL gateway</a></h2>
<ul>
<li>Gateway GraphQL over downstream subgraph
<ul>
<li>Gateway over &quot;countries&quot; graph trevorblades</li>
<li><a href="https://countries.trevorblades.com/">https://countries.trevorblades.com/</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Using Hotchocolate GraphQL gateway</p>
</blockquote>
<p><strong>GraphQL configuration</strong></p>
<pre><code class="language-c#">var builder = services.AddGraphQLServer();

foreach (var scalar in gatewayOptions.Scalars)
{
    builder.AddType(new AnyType(scalar));
}

foreach (var schema in gatewayOptions.Schemas)
{
    services
        .AddHttpClient(schema.Name, c =&gt; c.BaseAddress = new Uri(schema.Url))
        .AddHttpMessageHandler&lt;BffAuthenticationHeaderHandler&gt;();

    builder.AddRemoteSchema(schema.Name);

    var subgraph = services.AddGraphQL(schema.Name);
    foreach (var scalar in gatewayOptions.Scalars)
    {
        subgraph.AddType(new AnyType(scalar));
    }
}

builder.AddTypeExtensionsFromFile(&quot;./stitching.graphql&quot;);
</code></pre>
<p><strong>appsettings.development.json</strong></p>
<pre><code class="language-json">  &quot;GraphQLGateway&quot;: {
    &quot;Scalars&quot; : [&quot;date&quot;, &quot;timestamptz&quot;, &quot;uuid&quot;],
    &quot;Schemas&quot;: [
      {
        &quot;Name&quot;: &quot;Countries&quot;,
        &quot;Url&quot;: &quot;https://countries.trevorblades.com/&quot;
      }
    ]
  },
</code></pre>
<h2 id="auto-generated-sdk-1"><a class="header" href="#auto-generated-sdk-1">Auto generated SDK</a></h2>
<ul>
<li>SDK to consume BFF GraphQL schema
<ul>
<li>Auto generate it from BFF url</li>
<li>Use it in frontend application</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Using Hotchocolate <a href="https://chillicream.com/docs/strawberryshake/v13">Strawberry Shake</a></p>
</blockquote>
<pre><code class="language-console">cd ./src/blazor/Microscope.Boilerplate.Clients.SDK.GraphQL
dotnet new tool-manifest
dotnet tool install StrawberryShake.Tools
dotnet add package StrawberryShake.Blazor
dotnet graphql init http://localhost:5215/graphql -n BffClient
</code></pre>
<pre><code class="language-graphql">query GetContinents {
    continents {
        name
    }
}
</code></pre>
<pre><code class="language-console">dotnet build
</code></pre>
<p>Add SDK reference to Blazor project</p>
<pre><code class="language-c#">&lt;UseGetContinents Context=&quot;result&quot;&gt;
    &lt;ChildContent&gt;
        &lt;MudPaper&gt;
            &lt;MudList&gt;
                @foreach (var item in result.Continents)
                {
                    &lt;MudListItem Icon=&quot;@Icons.Material.Filled.List&quot;&gt;@item.Name&lt;/MudListItem&gt;
                }
            &lt;/MudList&gt;
        &lt;/MudPaper&gt;
    &lt;/ChildContent&gt;
    &lt;ErrorContent&gt;
        @result.First().Message
    &lt;/ErrorContent&gt;
    &lt;LoadingContent&gt;
        &lt;MudSkeleton SkeletonType=&quot;SkeletonType.Rectangle&quot; Height=&quot;50px&quot; /&gt;
        &lt;MudSkeleton SkeletonType=&quot;SkeletonType.Rectangle&quot; Height=&quot;50px&quot; Class=&quot;mt-4&quot; /&gt;
    &lt;/LoadingContent&gt;
&lt;/UseGetContinents&gt;
</code></pre>
<h2 id="light--dark-theme-1"><a class="header" href="#light--dark-theme-1">Light / Dark theme</a></h2>
<ul>
<li>Theme switcher implementation</li>
</ul>
<blockquote>
<p>💡 Using MudBlazor &quot;MudThemingProvider&quot;</p>
</blockquote>
<p><strong>Defining theme</strong></p>
<pre><code class="language-c#">public static MudTheme DarkTheme = new MudTheme()
{
    Palette = new Palette()
    {
        Black = &quot;#27272f&quot;,
        Background = &quot;#32333d&quot;,
        BackgroundGrey = &quot;#27272f&quot;,
        Primary = Colors.Cyan.Darken3,
        Surface = &quot;#373740&quot;,
        DrawerBackground = &quot;#27272f&quot;,
        DrawerText = &quot;rgba(255,255,255, 0.50)&quot;,
        AppbarBackground = &quot;#27272f&quot;,
        AppbarText = &quot;rgba(255,255,255, 0.70)&quot;,
        TextPrimary = &quot;rgba(255,255,255, 0.70)&quot;,
        TextSecondary = &quot;rgba(255,255,255, 0.50)&quot;,
        ActionDefault = &quot;#ffffff&quot;,
        ActionDisabled = &quot;rgba(255,255,255, 0.26)&quot;,
        ActionDisabledBackground = &quot;rgba(255,255,255, 0.12)&quot;,
        DrawerIcon = &quot;rgba(255,255,255, 0.50)&quot;
    }
};
</code></pre>
<p><strong>Apply theme</strong></p>
<pre><code class="language-c#">&lt;MudThemingProvider Theme=&quot;_currentTheme&quot; /&gt;
</code></pre>
<h2 id="i18n-1"><a class="header" href="#i18n-1">I18N</a></h2>
<ul>
<li>I18N switcher : FR &amp; EN</li>
</ul>
<blockquote>
<p>💡 Using resources files &amp; Localization</p>
</blockquote>
<p><strong>server side &amp; client side</strong></p>
<pre><code class="language-c#">services.AddLocalization(options =&gt; options.ResourcesPath = &quot;Resources&quot; );
</code></pre>
<p><strong>set culture endpoint</strong></p>
<pre><code class="language-c#">app.MapGet(&quot;/culture&quot;, (HttpContext context, string? culture, string? redirectUri) =&gt;
{
    if (culture != null)
    {
        var requestCulture = new RequestCulture(culture, culture);
        var cookieName = CookieRequestCultureProvider.DefaultCookieName;
        var cookieValue = CookieRequestCultureProvider.MakeCookieValue(requestCulture);

        context.Response.Cookies.Append(cookieName, cookieValue);
    }

    return Results.Redirect(redirectUri ?? &quot;/&quot;);
});
</code></pre>
<p><strong>client side set culture based on cookie (for SSR WASM fallback)</strong></p>
<pre><code class="language-c#">var host = builder.Build();

var cookieService = host.Services.GetRequiredService&lt;CookieService&gt;();
var cultureCookie = await cookieService.GetCultureFromCookie();

if (!string.IsNullOrEmpty(cultureCookie))
{
    var culture = CookieRequestCultureProvider.ParseCookieValue(cultureCookie)?.Cultures.FirstOrDefault().ToString();
    if (culture is not null)
    {
        var cultureInfo = new CultureInfo(culture);
        CultureInfo.DefaultThreadCurrentCulture = cultureInfo;
        CultureInfo.DefaultThreadCurrentUICulture = cultureInfo;
    }
}

await host.RunAsync();
</code></pre>
<p><strong>razor page</strong></p>
<pre><code class="language-c#">@inject IStringLocalizer&lt;Continents&gt; Loc
&lt;MudText Class=&quot;mb-8&quot;&gt;@Loc[&quot;SubTitle&quot;]&lt;/MudText&gt;
</code></pre>
<h2 id="feature-management-1"><a class="header" href="#feature-management-1">Feature management</a></h2>
<ul>
<li>BFF expose feature management configuration
<ul>
<li>Enable / disable flag from config</li>
<li>A/B testing use case</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Using Microsoft.FeatureManagement.AspNetCore</p>
</blockquote>
<p><strong>client page</strong></p>
<pre><code class="language-c#">public class ClientFeatureManagementService(HttpClient client) : IFeatureManagementService
{
    public async Task&lt;Dictionary&lt;string, bool&gt;?&gt; GetFeatureManagement()
    {
        return await client.GetFromJsonAsync&lt;Dictionary&lt;string, bool&gt;&gt;(&quot;/api/features&quot;);
    }
}
</code></pre>
<p><strong>server page</strong></p>
<pre><code class="language-c#">public class ServerFeatureManagementService(IFeatureManager featureManager) : IFeatureManagementService
{
    public async Task&lt;Dictionary&lt;string, bool&gt;?&gt; GetFeatureManagement()
    {
        return await featureManager.GetFeatureNamesAsync()
            .ToDictionaryAsync(
                feature =&gt; feature, 
                feature =&gt; featureManager.IsEnabledAsync(feature).GetAwaiter().GetResult());
    }
}
</code></pre>
<p><strong>endpoint feature management</strong></p>
<pre><code class="language-c#">public static void MapFeatureManagementEndpoints(this WebApplication app)
{
    app.MapGet(&quot;/api/features&quot;, async (IFeatureManagementService featureManagementService) =&gt; 
        await featureManagementService.GetFeatureManagement());
}
</code></pre>
<p><strong>pages or layout</strong></p>
<pre><code class="language-c#">@if (IsUserPageEnabled)
{
    &lt;MudNavLink Href=&quot;user&quot; Match=&quot;NavLinkMatch.Prefix&quot; Icon=&quot;@Icons.Material.Filled.VerifiedUser&quot;&gt;@Loc[&quot;User&quot;]&lt;/MudNavLink&gt;
}
// ...
private bool IsUserPageEnabled { get; set; }
// ...
var features = await FeatureManagementService.GetFeatureManagement();
IsUserPageEnabled = features.FirstOrDefault(x =&gt; x.Key == &quot;ShowUserPage&quot;).Value;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="angular-1"><a class="header" href="#angular-1">Angular</a></h1>
<img src="https://cdn4.iconfinder.com/data/icons/logos-and-brands/512/21_Angular_logo_logos-512.png" width="40">
<blockquote>
<p>The web development framework for building the future</p>
</blockquote>
<ul>
<li><a href="https://angular.io/">Web site</a></li>
<li><a href="https://github.com/angular/angular">Github</a></li>
</ul>
<p><img src="technos/../public/angular.png" alt="../public/angular.png" /></p>
<h2 id="features-1"><a class="header" href="#features-1">Features</a></h2>
<h2 id="material-ui-2"><a class="header" href="#material-ui-2">Material UI</a></h2>
<ul>
<li>Add material UI design system
<ul>
<li>color primary by techno</li>
<li>layout with app bar &amp; collapsable sidemenu to rail</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Easy intergration using <a href="https://material.angular.io/">&quot;@angular/material&quot;</a> package</p>
</blockquote>
<pre><code class="language-html">&lt;mat-toolbar color=&quot;primary&quot;&gt;
  &lt;mat-icon style=&quot;cursor: pointer;&quot; (click)=&quot;toggle()&quot; aria-hidden=&quot;false&quot; aria-label=&quot;Example home icon&quot; fontIcon=&quot;menu&quot;&gt;&lt;/mat-icon&gt;
  &lt;span style=&quot;margin-left: 10px; font-weight: normal; font-size: medium;&quot;&gt;Microscope.Boilerplate.Angular&lt;/span&gt;
  &lt;span class=&quot;spacer&quot;&gt;&lt;/span&gt;
  
  &lt;button *ngIf=&quot;!isAuthenticated&quot; mat-icon-button (click)=&quot;login()&quot;&gt;
    &lt;mat-icon&gt;account_circle&lt;/mat-icon&gt;
  &lt;/button&gt;

  &lt;button *ngIf=&quot;isAuthenticated&quot; mat-button [matMenuTriggerFor]=&quot;menu&quot;&gt;AD&lt;/button&gt;
  &lt;mat-menu #menu=&quot;matMenu&quot;&gt;
    &lt;button mat-menu-item (click)=&quot;goToAccount()&quot;&gt;Account&lt;/button&gt;
    &lt;button mat-menu-item (click)=&quot;logout()&quot;&gt;Logout&lt;/button&gt;
  &lt;/mat-menu&gt;

&lt;/mat-toolbar&gt;

&lt;mat-sidenav-container class=&quot;sidenav-container&quot;&gt;
  &lt;mat-sidenav class=&quot;sidenav&quot; mode=&quot;side&quot; [(opened)]=&quot;opened&quot; &gt;
    &lt;mat-nav-list&gt;
      &lt;mat-list-item routerLink=&quot;/&quot; routerLinkActive=&quot;active&quot;&gt;&lt;mat-icon class=&quot;v-align&quot; fontIcon=&quot;home&quot;&gt;&lt;/mat-icon&gt;&lt;span&gt;Home&lt;/span&gt;&lt;/mat-list-item&gt;
      &lt;mat-list-item routerLink=&quot;/counter&quot; routerLinkActive=&quot;active&quot;&gt;&lt;mat-icon class=&quot;v-align&quot; fontIcon=&quot;add&quot;&gt;&lt;/mat-icon&gt;&lt;span&gt;Counter&lt;/span&gt;&lt;/mat-list-item&gt;
      &lt;mat-list-item routerLink=&quot;/posts&quot; routerLinkActive=&quot;active&quot;&gt;&lt;mat-icon class=&quot;v-align&quot; fontIcon=&quot;list&quot;&gt;&lt;/mat-icon&gt;&lt;span&gt;Posts&lt;/span&gt;&lt;/mat-list-item&gt;
      &lt;mat-list-item routerLink=&quot;/user&quot; routerLinkActive=&quot;active&quot;&gt;&lt;mat-icon class=&quot;v-align&quot; fontIcon=&quot;verified_user&quot;&gt;&lt;/mat-icon&gt;&lt;span&gt;User&lt;/span&gt;&lt;/mat-list-item&gt;
    &lt;/mat-nav-list&gt;
  &lt;/mat-sidenav&gt;
  &lt;mat-sidenav-content class=&quot;sidenav-content&quot;&gt;
    &lt;router-outlet&gt;&lt;/router-outlet&gt;
  &lt;/mat-sidenav-content&gt;
&lt;/mat-sidenav-container&gt;
</code></pre>
<pre><code class="language-js">export class AppComponent implements OnInit {
    public opened: boolean = true;
    // ..
    toggle() {
        this.opened = !this.opened;
    }
    // ..
}
</code></pre>
<h2 id="custom-endpoint-1"><a class="header" href="#custom-endpoint-1">Custom endpoint</a></h2>
<blockquote>
<p>💡 Expose custom server endpoint to &quot;/version&quot; using a express API endpoint</p>
</blockquote>
<pre><code class="language-js">server.get('/version', (req, res) =&gt; {
    res.json({ version: '1.0.0' })
})
</code></pre>
<h2 id="server-side-rendering-2"><a class="header" href="#server-side-rendering-2">Server side rendering</a></h2>
<ul>
<li>Expose frontend web application with SSR
<ul>
<li>pre-rendering page with data</li>
<li>fallback into interactive UI</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Let angular universal handle the magic : </p>
</blockquote>
<p><strong>server.ts</strong></p>
<pre><code class="language-js">  import { CommonEngine } from '@angular/ssr';

  // All regular routes use the Angular engine
  server.get('*', (req, res, next) =&gt; {
    const { protocol, originalUrl, baseUrl, headers } = req;

    commonEngine
      .render({
        bootstrap,
        documentFilePath: indexHtml,
        url: `${protocol}://${headers.host}${originalUrl}`,
        publicPath: browserDistFolder,
        providers: [{ provide: APP_BASE_HREF, useValue: baseUrl }],
      })
      .then((html) =&gt; res.send(html))
      .catch((err) =&gt; next(err));
  });
</code></pre>
<h2 id="oidc--cookie-authentication-2"><a class="header" href="#oidc--cookie-authentication-2">OIDC &amp; cookie authentication</a></h2>
<ul>
<li>Handle OIDC auth over keycloak SSO</li>
<li>Cookie &amp; antiforgery token</li>
<li>Login / Logout clean process</li>
</ul>
<blockquote>
<p>💡 Using angular-oauth2-oidc package for angular authentication</p>
</blockquote>
<blockquote>
<p>🚨 Authentication is handle here client side &amp; secret token is in the browser ... to improve</p>
</blockquote>
<p><strong>oidc.service.ts</strong></p>
<pre><code class="language-js">import { AuthConfig, OAuthService } from 'angular-oauth2-oidc';

@Injectable({
    providedIn: 'root',
})
export class AuthService {
    private oAuthService = inject(OAuthService);
    private router = inject(Router);

    constructor() {
        this.initConfiguration();
    }

    initConfiguration() {
        const authConfig: AuthConfig = {
            issuer: 'http://localhost:8083/realms/microscope/',
            clientId: 'boilerplate',
            dummyClientSecret: 'JxaXjmKOd08cMpaKrThAObUzeOmyRiLN',
            scope: 'roles',
            responseType: 'code',
            redirectUri: 'http://localhost:4200/',
            strictDiscoveryDocumentValidation: false,
            skipIssuerCheck: true
        };

        this.oAuthService.configure(authConfig);
        this.oAuthService.setupAutomaticSilentRefresh();
        this.oAuthService.loadDiscoveryDocumentAndTryLogin();
    }

    login() {
        this.oAuthService.initLoginFlow();
    }
    // ..
}
</code></pre>
<h2 id="proxying-api-2"><a class="header" href="#proxying-api-2">Proxying API</a></h2>
<ul>
<li>Proxying downsteam REST API
<ul>
<li>Proxying jsonplaceholder &quot;todos&quot; API with route &quot;/api/todos&quot;</li>
<li><a href="https://jsonplaceholder.typicode.com/">https://jsonplaceholder.typicode.com/</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 Using <a href="technos/express-http-proxy">express-http-proxy</a> package</p>
</blockquote>
<p><strong>server.ts</strong></p>
<pre><code class="language-js">import proxy from 'express-http-proxy';
// ...
server.use('/api', proxy('https://jsonplaceholder.typicode.com'));
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="next"><a class="header" href="#next">Next</a></h1>
<img src="https://seeklogo.com/images/N/next-js-logo-8FCFF51DD2-seeklogo.com.png" width="40">
<blockquote>
<p>The React Framework for the Web</p>
</blockquote>
<ul>
<li><a href="https://nextjs.org/">Web site</a></li>
<li><a href="https://github.com/vercel/next.js">Github</a></li>
</ul>
<p><img src="technos/../public/nextjs.png" alt="../public/nextjs.png" /></p>
<h2 id="features-2"><a class="header" href="#features-2">Features</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nuxt-1"><a class="header" href="#nuxt-1">Nuxt</a></h1>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Nuxt_logo.svg/2560px-Nuxt_logo.svg.png" width="40">
<blockquote>
<p>The Intuitive Vue Framework</p>
</blockquote>
<ul>
<li><a href="https://nuxt.com/">Web site</a></li>
<li><a href="https://github.com/nuxt/nuxt">Github</a></li>
</ul>
<p><img src="technos/../public/nuxt.png" alt="../public/nuxt.png" /></p>
<h2 id="features-3"><a class="header" href="#features-3">Features</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="yew"><a class="header" href="#yew">Yew</a></h1>
<img src="https://yew.rs/img/logo.svg" width="40">
<blockquote>
<p>A framework for creating reliable and efficient web applications.</p>
</blockquote>
<ul>
<li><a href="https://yew.rs/">Web site</a></li>
<li><a href="https://github.com/yewstack/yew">Github</a></li>
</ul>
<h2 id="features-4"><a class="header" href="#features-4">Features</a></h2>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
